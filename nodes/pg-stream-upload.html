<!-- pg-stream-upload.html -->
<script type="text/javascript">
  RED.nodes.registerType('pg-stream-upload', {
    category: 'storage',
    color: '#A6BBCF',
    defaults: {
      name: { value: '' },
      pgConfig: { value: '', type: 'pg-config', required: true },
    },
    inputs: 1,
    outputs: 1,
    icon: 'db.png',
    label: function () {
      return this.name || 'pg-stream-upload';
    },
  });
</script>

<script type="text/x-red" data-template-name="pg-stream-upload">
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name" placeholder="Name">
  </div>
  <div class="form-row">
    <label for="node-input-pgConfig"><i class="fa fa-database"></i> PostgreSQL</label>
    <input type="text" id="node-input-pgConfig">
  </div>
</script>

<script type="text/x-red" data-help-name="pg-stream-upload">
  <p>Uploads a file stream to PostgreSQL as a Large Object.</p>
  <p>This node is designed to work with the <code>stream-upload</code> node or any other node that provides a readable stream in <code>msg.payload</code>.</p>

  <h3>Inputs</h3>
  <dl class="message-properties">
      <dt>payload
          <span class="property-type">stream</span>
      </dt>
      <dd>The readable stream of the file to be uploaded.</dd>
      <dt>filename
          <span class="property-type">string</span>
      </dt>
      <dd>(Optional) The name of the file.</dd>
      <dt>mimetype
          <span class="property-type">string</span>
      </dt>
      <dd>(Optional) The MIME type of the file.</dd>
  </dl>

  <h3>Outputs</h3>
  <dl class="message-properties">
      <dt>payload
          <span class="property-type">object</span>
      </dt>
      <dd>An object containing the result of the upload.</dd>
  </dl>
  <h4>Payload Object</h4>
  <dl class="message-properties">
      <dt>oid
          <span class="property-type">number</span>
      </dt>
      <dd>The Object ID (OID) of the created Large Object in PostgreSQL.</dd>
      <dt>filename
          <span class="property-type">string</span>
      </dt>
      <dd>The name of the file that was uploaded.</dd>
      <dt>mimetype
          <span class="property-type">string</span>
      </dt>
      <dd>The MIME type of the file.</dd>
  </dl>
</script>
